> openvpn --genkey --secret $EASYRSA_PKI/ta.key
> 
> ta.key用于防御DoS、UDP淹没等恶意攻击(可选)


> 附录
>
> A发送一条带有时间戳的消息给公钥目录管理员,以请求B的公钥。
>
> 管理员M给A发送一条用其私钥SK<sub>M</sub>签名的包括B的公钥PK<sub>B</sub>在内的消息,A用管理员公钥PK<sub>M</sub>解密得到B的公钥PK<sub>B</sub>
> 
> A用B的公钥加密ID<sub>A</sub>‖N<sub>1</sub>发送给B表示请求和B通信,B用其私钥SK<sub>B</sub>解密成功,就同意通信,然后B以同样的方法从管理员处检索到A的公钥。</span></p>
---
> 为解决公钥管理机构瓶颈的问题,可以通过公钥证书来实现。公钥证书由认证机构CA为用户颁发。这样,用户能安全地获得其他用户的公钥的前提是只要得到CA的公钥。
>
> 由于只有CA的公钥才能解读证书,接收方如果使用CA的公钥解密成功,就能确信证书是由CA颁发的,同时表明证书中的内容没有被篡改过,由于证书将A的身份标识和A的公钥绑定在一起,因此接收方可确信PK<sub>A</sub>就是用户A的公钥。时间戳T主要用来表明证书没有过期,防止攻击者重放旧证书

> DH相关说明:
> https://www.bilibili.com/video/BV1QE41127Bb?from=search&seid=13051915212100285129
>
>红黄蓝=A  红黄=B 红蓝=C
>
>公开的只有 红BC
>
>只有 双方才知道 A

> 1.有两个全局公开的参数，一个素数q和一个整数a，a是q的一个原根。
> 
> 2、假设用户A和B希望交换一个密钥，用户A选择一个作为私有密钥的随机数XA<q，并计算公开密钥YA=a^XA mod q。A对XA的值保密存放而使YA能被B公开获得。类似地，用户B选择一个私有的随机数XB<q，并计算公开密钥YB=a^XB mod q。B对XB的值保密存放而使YB能被A公开获得。
>
> 3、用户A产生共享秘密密钥的计算方式是K = (YB)^XA mod q。同样，用户B产生共享秘密密钥的计算是K = (YA)^XB mod q。这两个计算产生相同的结果



> [李芳，唐磊，张智编,计算机网络安全,西南交通大学出版社,2017.12,第128页]
>
>最简单形式的Differ-Hellman不能为两个通信者提供认证
>
>一种很好的替代方法就是使用公钥证书。当Bob想要与Alice通信时，他可按下面的步骤操作：
>
>(1)准备消息；
>
>(2)利用一次性传统会话密钥，使用传统加密方法加密消息；
>
>(3)利用Aice的公钥，使用公钥加密的方法加密会话密钥；
>
>(4)把加密的会话密钥附在消息上，并且把它发送给Aice，只有Aice能够解密会话密钥进而恢复原始消
息。如果Bob通过Alice的公钥证书获得Alice的公钥，则Bob能够确定它是有效的密钥。

